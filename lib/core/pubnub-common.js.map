{"version":3,"sources":["core/pubnub-common.js"],"names":["messageCountsConfig","addMessageMetadataConfig","getMessageReactions","deleteMessageMetadataConfig","setUserDataConfig","getUserDataConfig","getUsersDataConfig","setDeviceDataConfig","getDeviceDataConfig","deleteUserDataConfig","deleteDeviceDataConfig","addDeviceToUserConfig","removeDeviceFromUserConfig","listDevicesForUserConfig","getChannelsDataConfig","addChannelDataConfig","updateChannelDataConfig","getChannelDataConfig","deleteChannelDataConfig","addUserToChannelConfig","removeUserFromChannelConfig","listUsersInChannelConfig","listChannelsForUserConfig","addDeviceToChannelConfig","removeDeviceFromChannelConfig","listDevicesInChannelConfig","listChannelsForDeviceConfig","addChannelsChannelGroupConfig","removeChannelsChannelGroupConfig","deleteChannelGroupConfig","listChannelGroupsConfig","listChannelsInChannelGroupConfig","addPushChannelsConfig","removePushChannelsConfig","listPushChannelsConfig","removeDevicePushConfig","presenceLeaveEndpointConfig","presenceWhereNowEndpointConfig","presenceHeartbeatEndpointConfig","presenceGetStateConfig","presenceSetStateConfig","presenceHereNowConfig","auditEndpointConfig","grantEndpointConfig","publishEndpointConfig","historyEndpointConfig","deleteMessagesEndpointConfig","fetchMessagesEndpointConfig","timeEndpointConfig","subscribeEndpointConfig","setup","db","networking","config","_config","Config","crypto","Crypto","init","modules","timeEndpoint","endpointCreator","bind","leaveEndpoint","heartbeatEndpoint","setStateEndpoint","subscribeEndpoint","listenerManager","_listenerManager","ListenerManager","subscriptionManager","SubscriptionManager","addListener","removeListener","removeAllListeners","channelGroups","listGroups","listChannels","addChannels","removeChannels","deleteGroup","push","deleteDevice","hereNow","whereNow","getState","setState","adaptStateChange","grant","audit","publish","messageCounts","addMessageReaction","deleteMessageMetadata","setUserData","getUserData","getUsersData","deleteUserData","setDeviceData","getDeviceData","deleteDeviceData","addDeviceToUser","removeDeviceFromUser","listDevicesForUser","addUserToVirtualSpace","removeUserFromVirtualSpace","listUsersInVirtualSpace","listVirtualSpacesForUser","addDeviceToVirtualSpace","removeDeviceFromVirtualSpace","listDeviceInVirtualSpace","getVirtualSpaces","addVirtualSpace","updateVirtualSpace","getVirtualSpace","deleteVirtualSpace","fire","args","callback","replicate","storeInHistory","history","deleteMessages","fetchMessages","time","subscribe","adaptSubscribeChange","presence","adaptPresenceChange","unsubscribe","adaptUnsubscribeChange","disconnect","reconnect","destroy","isOffline","unsubscribeAll","stop","getSubscribedChannels","getSubscribedChannelGroups","encrypt","decrypt","getAuthKey","setAuthKey","setCipherKey","getUUID","setUUID","getFilterExpression","setFilterExpression","setHeartbeatInterval","hasModule","setProxy","proxy","getVersion","announceNetworkDown","restore","announceNetworkUp","uuidGenerator","createUUID","OPERATIONS","CATEGORIES"],"mappings":"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","file":"pubnub-common.js","sourcesContent":["/* @flow */\n\nimport Config from './components/config';\nimport Crypto from './components/cryptography/index';\nimport SubscriptionManager from './components/subscription_manager';\nimport ListenerManager from './components/listener_manager';\n\nimport endpointCreator from './components/endpoint';\n\n/* message data */\nimport * as messageCountsConfig from './endpoints/uuid_metadata/message_counts';\nimport * as addMessageMetadataConfig from './endpoints/uuid_metadata/set_message_metadata';\nimport * as getMessageReactions from './endpoints/uuid_metadata/get_message_metadata';\nimport * as deleteMessageMetadataConfig from './endpoints/uuid_metadata/delete_message_metadata';\n\n/* user, device, and channel data */\nimport * as setUserDataConfig from './endpoints/uuid_metadata/set_user_metadata';\nimport * as getUserDataConfig from './endpoints/uuid_metadata/get_user_metadata';\nimport * as getUsersDataConfig from './endpoints/uuid_metadata/get_users_metadata';\nimport * as setDeviceDataConfig from './endpoints/uuid_metadata/set_device_metadata';\nimport * as getDeviceDataConfig from './endpoints/uuid_metadata/get_device_metadata';\nimport * as deleteUserDataConfig from './endpoints/uuid_metadata/delete_user_metadata';\nimport * as deleteDeviceDataConfig from './endpoints/uuid_metadata/delete_device_metadata';\n\n\nimport * as addDeviceToUserConfig from './endpoints/uuid_metadata/add_device_to_user';\nimport * as removeDeviceFromUserConfig from './endpoints/uuid_metadata/remove_device_from_user';\nimport * as listDevicesForUserConfig from './endpoints/uuid_metadata/list_devices_for_user';\n\nimport * as getChannelsDataConfig from './endpoints/uuid_metadata/get_channels_metadata';\nimport * as addChannelDataConfig from './endpoints/uuid_metadata/add_channel_metadata';\nimport * as updateChannelDataConfig from './endpoints/uuid_metadata/update_channel_metadata';\nimport * as getChannelDataConfig from './endpoints/uuid_metadata/get_channel_metadata';\nimport * as deleteChannelDataConfig from './endpoints/uuid_metadata/delete_channel_metadata';\nimport * as addUserToChannelConfig from './endpoints/uuid_metadata/add_user_to_channel';\nimport * as removeUserFromChannelConfig from './endpoints/uuid_metadata/remove_user_from_channel';\nimport * as listUsersInChannelConfig from './endpoints/uuid_metadata/list_users_in_channel';\nimport * as listChannelsForUserConfig from './endpoints/uuid_metadata/list_channels_for_user';\nimport * as addDeviceToChannelConfig from './endpoints/uuid_metadata/add_device_to_channel';\nimport * as removeDeviceFromChannelConfig from './endpoints/uuid_metadata/remove_device_from_channel';\nimport * as listDevicesInChannelConfig from './endpoints/uuid_metadata/list_devices_in_channel';\nimport * as listChannelsForDeviceConfig from './endpoints/uuid_metadata/list_channels_for_device';\n\nimport * as addChannelsChannelGroupConfig from './endpoints/channel_groups/add_channels';\nimport * as removeChannelsChannelGroupConfig from './endpoints/channel_groups/remove_channels';\nimport * as deleteChannelGroupConfig from './endpoints/channel_groups/delete_group';\nimport * as listChannelGroupsConfig from './endpoints/channel_groups/list_groups';\nimport * as listChannelsInChannelGroupConfig from './endpoints/channel_groups/list_channels';\n\nimport * as addPushChannelsConfig from './endpoints/push/add_push_channels';\nimport * as removePushChannelsConfig from './endpoints/push/remove_push_channels';\nimport * as listPushChannelsConfig from './endpoints/push/list_push_channels';\nimport * as removeDevicePushConfig from './endpoints/push/remove_device';\n\nimport * as presenceLeaveEndpointConfig from './endpoints/presence/leave';\nimport * as presenceWhereNowEndpointConfig from './endpoints/presence/where_now';\nimport * as presenceHeartbeatEndpointConfig from './endpoints/presence/heartbeat';\nimport * as presenceGetStateConfig from './endpoints/presence/get_state';\nimport * as presenceSetStateConfig from './endpoints/presence/set_state';\nimport * as presenceHereNowConfig from './endpoints/presence/here_now';\n\nimport * as auditEndpointConfig from './endpoints/access_manager/audit';\nimport * as grantEndpointConfig from './endpoints/access_manager/grant';\n\nimport * as publishEndpointConfig from './endpoints/publish';\nimport * as historyEndpointConfig from './endpoints/history/get_history';\nimport * as deleteMessagesEndpointConfig from './endpoints/history/delete_messages';\nimport * as fetchMessagesEndpointConfig from './endpoints/fetch_messages';\nimport * as timeEndpointConfig from './endpoints/time';\nimport * as subscribeEndpointConfig from './endpoints/subscribe';\n\nimport OPERATIONS from './constants/operations';\nimport CATEGORIES from './constants/categories';\n\nimport { InternalSetupStruct } from './flow_interfaces';\nimport uuidGenerator from './components/uuid';\n\nexport default class {\n\n  _config: Config;\n  _listenerManager: ListenerManager;\n\n  // tell flow about the mounted endpoint\n  time: Function;\n  publish: Function;\n  fire: Function;\n\n  history: Function;\n  deleteMessages: Function;\n  fetchMessages: Function;\n\n  //\n  channelGroups: Object;\n  //\n  push: Object;\n  //\n  hereNow: Function;\n  whereNow: Function;\n  getState: Function;\n  setState: Function;\n  //\n  grant: Function;\n  audit: Function;\n  //\n  subscribe: Function;\n  presence: Function;\n  unsubscribe: Function;\n  unsubscribeAll: Function;\n\n  disconnect: Function;\n  reconnect: Function;\n\n\n  destroy: Function;\n  stop: Function;\n\n  getSubscribedChannels: Function;\n  getSubscribedChannelGroups: Function;\n\n  addListener: Function;\n  removeListener: Function;\n  removeAllListeners: Function;\n\n  getAuthKey: Function;\n  setAuthKey: Function;\n\n  setCipherKey: Function;\n  setUUID: Function;\n  getUUID: Function;\n\n  getFilterExpression: Function;\n  setFilterExpression: Function;\n\n  setHeartbeatInterval: Function;\n\n  setProxy: Function;\n\n  encrypt: Function;\n  decrypt: Function;\n\n  //\n\n  constructor(setup: InternalSetupStruct) {\n    let { db, networking } = setup;\n\n    const config = this._config = new Config({ setup, db });\n    const crypto = new Crypto({ config });\n    networking.init(config);\n\n    let modules = { config, networking, crypto };\n    const timeEndpoint = endpointCreator.bind(this, modules, timeEndpointConfig);\n    const leaveEndpoint = endpointCreator.bind(this, modules, presenceLeaveEndpointConfig);\n    const heartbeatEndpoint = endpointCreator.bind(this, modules, presenceHeartbeatEndpointConfig);\n    const setStateEndpoint = endpointCreator.bind(this, modules, presenceSetStateConfig);\n    const subscribeEndpoint = endpointCreator.bind(this, modules, subscribeEndpointConfig);\n\n    // managers\n    const listenerManager = this._listenerManager = new ListenerManager();\n\n    const subscriptionManager = new SubscriptionManager({\n      timeEndpoint,\n      leaveEndpoint,\n      heartbeatEndpoint,\n      setStateEndpoint,\n      subscribeEndpoint,\n      crypto: modules.crypto,\n      config: modules.config,\n      listenerManager\n    });\n\n    this.addListener = listenerManager.addListener.bind(listenerManager);\n    this.removeListener = listenerManager.removeListener.bind(listenerManager);\n    this.removeAllListeners = listenerManager.removeAllListeners.bind(listenerManager);\n\n    /* channel groups */\n    this.channelGroups = {\n      listGroups: endpointCreator.bind(this, modules, listChannelGroupsConfig),\n      listChannels: endpointCreator.bind(this, modules, listChannelsInChannelGroupConfig),\n      addChannels: endpointCreator.bind(this, modules, addChannelsChannelGroupConfig),\n      removeChannels: endpointCreator.bind(this, modules, removeChannelsChannelGroupConfig),\n      deleteGroup: endpointCreator.bind(this, modules, deleteChannelGroupConfig)\n    };\n    /* push */\n    this.push = {\n      addChannels: endpointCreator.bind(this, modules, addPushChannelsConfig),\n      removeChannels: endpointCreator.bind(this, modules, removePushChannelsConfig),\n      deleteDevice: endpointCreator.bind(this, modules, removeDevicePushConfig),\n      listChannels: endpointCreator.bind(this, modules, listPushChannelsConfig)\n    };\n    /* presence */\n    this.hereNow = endpointCreator.bind(this, modules, presenceHereNowConfig);\n    this.whereNow = endpointCreator.bind(this, modules, presenceWhereNowEndpointConfig);\n    this.getState = endpointCreator.bind(this, modules, presenceGetStateConfig);\n    this.setState = subscriptionManager.adaptStateChange.bind(subscriptionManager);\n    /* PAM */\n    this.grant = endpointCreator.bind(this, modules, grantEndpointConfig);\n    this.audit = endpointCreator.bind(this, modules, auditEndpointConfig);\n    //\n    this.publish = endpointCreator.bind(this, modules, publishEndpointConfig);\n\n    this.messageCounts = endpointCreator.bind(this, modules, messageCountsConfig);\n    this.addMessageReaction = endpointCreator.bind(this, modules, addMessageMetadataConfig);\n    this.getMessageReactions = endpointCreator.bind(this, modules, getMessageReactions);\n    this.deleteMessageMetadata = endpointCreator.bind(this, modules, deleteMessageMetadataConfig);\n    this.setUserData = endpointCreator.bind(this, modules, setUserDataConfig);\n    this.getUserData = endpointCreator.bind(this, modules, getUserDataConfig);\n    this.getUsersData = endpointCreator.bind(this, modules, getUsersDataConfig);\n    this.deleteUserData = endpointCreator.bind(this, modules, deleteUserDataConfig);\n    this.setDeviceData = endpointCreator.bind(this, modules, setDeviceDataConfig);\n    this.getDeviceData = endpointCreator.bind(this, modules, getDeviceDataConfig);\n    this.deleteDeviceData = endpointCreator.bind(this, modules, deleteDeviceDataConfig);\n    this.addDeviceToUser = endpointCreator.bind(this, modules, addDeviceToUserConfig);\n    this.removeDeviceFromUser = endpointCreator.bind(this, modules, removeDeviceFromUserConfig);\n    this.listDevicesForUser = endpointCreator.bind(this, modules, listDevicesForUserConfig);\n\n    /*\n    this.addUuidToChannelGroup = endpointCreator.default.bind(this, modules, addUuidToChannelGroupConfig);\n    this.removeUuidFromChannelGroup = endpointCreator.default.bind(this, modules, removeUuidFromChannelGroupConfig);\n    this.listUuidsInChannelGroup = endpointCreator.default.bind(this, modules, listUuidsInChannelGroupConfig);\n    this.setChannelGroupMetadata = endpointCreator.default.bind(this, modules, setChannelGroupMetadataConfig);\n    this.getChannelGroupMetadata = endpointCreator.default.bind(this, modules, getChannelGroupMetadataConfig);\n    this.deleteChannelGroupMetadata = endpointCreator.default.bind(this, modules, deleteChannelGroupMetadataConfig);\n    */\n    this.addUserToVirtualSpace = endpointCreator.bind(this, modules, addUserToChannelConfig);\n    this.removeUserFromVirtualSpace = endpointCreator.bind(this, modules, removeUserFromChannelConfig);\n    this.listUsersInVirtualSpace = endpointCreator.bind(this, modules, listUsersInChannelConfig);\n    this.listVirtualSpacesForUser = endpointCreator.bind(this, modules, listChannelsForUserConfig);\n    this.addDeviceToVirtualSpace = endpointCreator.bind(this, modules, addDeviceToChannelConfig);\n    this.removeDeviceFromVirtualSpace = endpointCreator.bind(this, modules, removeDeviceFromChannelConfig);\n    this.listDeviceInVirtualSpace = endpointCreator.bind(this, modules, listDevicesInChannelConfig);\n    this.listDevicesForUser = endpointCreator.bind(this, modules, listChannelsForDeviceConfig);\n    this.getVirtualSpaces = endpointCreator.bind(this, modules, getChannelsDataConfig);\n    this.addVirtualSpace = endpointCreator.bind(this, modules, addChannelDataConfig);\n    this.updateVirtualSpace = endpointCreator.bind(this, modules, updateChannelDataConfig);\n    this.getVirtualSpace = endpointCreator.bind(this, modules, getChannelDataConfig);\n    this.deleteVirtualSpace = endpointCreator.bind(this, modules, deleteChannelDataConfig);\n    \n    this.fire = (args, callback) => {\n      args.replicate = false;\n      args.storeInHistory = false;\n      return this.publish(args, callback);\n    };\n\n    this.history = endpointCreator.bind(this, modules, historyEndpointConfig);\n    this.deleteMessages = endpointCreator.bind(this, modules, deleteMessagesEndpointConfig);\n    this.fetchMessages = endpointCreator.bind(this, modules, fetchMessagesEndpointConfig);\n\n    this.time = timeEndpoint;\n\n    // subscription related methods\n    this.subscribe = subscriptionManager.adaptSubscribeChange.bind(subscriptionManager);\n    this.presence = subscriptionManager.adaptPresenceChange.bind(subscriptionManager);\n    this.unsubscribe = subscriptionManager.adaptUnsubscribeChange.bind(subscriptionManager);\n    this.disconnect = subscriptionManager.disconnect.bind(subscriptionManager);\n    this.reconnect = subscriptionManager.reconnect.bind(subscriptionManager);\n\n    this.destroy = (isOffline: boolean) => {\n      subscriptionManager.unsubscribeAll(isOffline);\n      subscriptionManager.disconnect();\n    };\n\n    // --- deprecated  ------------------\n    this.stop = this.destroy; // --------\n    // --- deprecated  ------------------\n\n    this.unsubscribeAll = subscriptionManager.unsubscribeAll.bind(subscriptionManager);\n\n    this.getSubscribedChannels = subscriptionManager.getSubscribedChannels.bind(subscriptionManager);\n    this.getSubscribedChannelGroups = subscriptionManager.getSubscribedChannelGroups.bind(subscriptionManager);\n\n    // mount crypto\n    this.encrypt = crypto.encrypt.bind(crypto);\n    this.decrypt = crypto.decrypt.bind(crypto);\n\n    /* config */\n    this.getAuthKey = modules.config.getAuthKey.bind(modules.config);\n    this.setAuthKey = modules.config.setAuthKey.bind(modules.config);\n    this.setCipherKey = modules.config.setCipherKey.bind(modules.config);\n    this.getUUID = modules.config.getUUID.bind(modules.config);\n    this.setUUID = modules.config.setUUID.bind(modules.config);\n    this.getFilterExpression = modules.config.getFilterExpression.bind(modules.config);\n    this.setFilterExpression = modules.config.setFilterExpression.bind(modules.config);\n\n    this.setHeartbeatInterval = modules.config.setHeartbeatInterval.bind(modules.config);\n\n    if (networking.hasModule('proxy')) {\n      this.setProxy = (proxy) => {\n        modules.config.setProxy(proxy);\n        this.reconnect();\n      };\n    }\n  }\n\n\n  getVersion(): string {\n    return this._config.getVersion();\n  }\n\n  // network hooks to indicate network changes\n  networkDownDetected() {\n    this._listenerManager.announceNetworkDown();\n\n    if (this._config.restore) {\n      this.disconnect();\n    } else {\n      this.destroy(true);\n    }\n  }\n\n  networkUpDetected() {\n    this._listenerManager.announceNetworkUp();\n    this.reconnect();\n  }\n\n\n  static generateUUID(): string {\n    return uuidGenerator.createUUID();\n  }\n\n  static OPERATIONS = OPERATIONS;\n  static CATEGORIES = CATEGORIES;\n\n}\n"]}